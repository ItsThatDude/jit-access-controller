## String to partially override chart.fullname template (will maintain the release name)
##
# nameOverride: ""

## String to fully override chart.fullname template
##
# fullnameOverride: ""

## Configure the controller manager deployment
##
manager:
  replicas: 1
  
  image:
    repository: itsthatdood/jit-access-controller
    tag: latest
    pullPolicy: IfNotPresent

  ## Arguments
  ##
  args:
    - --leader-elect

  ## Environment variables
  ##
  env:
    - name: SYSTEM_NAMESPACE
      valueFrom:
        fieldRef:
            fieldPath: metadata.namespace
    - name: SERVICE_ACCOUNT_NAME
      valueFrom:
        fieldRef:
            fieldPath: spec.serviceAccountName

  ## Image pull secrets
  ##
  imagePullSecrets: []

  ## Pod-level security settings
  ##
  podSecurityContext:
    runAsNonRoot: true
    seccompProfile:
        type: RuntimeDefault

  ## Container-level security settings
  ##
  securityContext:
    allowPrivilegeEscalation: false
    capabilities:
        drop:
            - ALL
    readOnlyRootFilesystem: true

  ## Resource limits and requests
  ##
  resources:
    limits:
        cpu: 500m
        memory: 128Mi
    requests:
        cpu: 10m
        memory: 64Mi

  ## Manager pod's affinity
  ##
  affinity: {}

  ## Manager pod's node selector
  ##
  nodeSelector: {}

  ## Manager pod's tolerations
  ##
  tolerations: []

## Helper RBAC roles for managing custom resources
##
rbacHelpers:
  # Install convenience admin/editor/viewer roles for CRDs
  enable: false

## Custom Resource Definitions
##
crd:
  # Install CRDs with the chart
  enable: true
  # Keep CRDs when uninstalling
  keep: true

## Controller metrics endpoint.
## Enable to expose /metrics endpoint with RBAC protection.
##
metrics:
  enable: true
  # Metrics server port
  port: 8443

## Cert-manager integration for TLS certificates.
## Required for webhook certificates and metrics endpoint certificates.
##
certManager:
  enable: true

## Webhook server configuration
##
webhook:
  enable: true
  # Webhook server port
  port: 9443

## Prometheus ServiceMonitor for metrics scraping.
## Requires prometheus-operator to be installed in the cluster.
##
prometheus:
  enable: false

## Frontend configuration
##
frontend:
  enable: true
    
  replicas: 1

  port: 8080

  impersonation:
    enable: false
    constrained: false

  oidc:
    secretRef: "frontend-oidc"
    authorityKey: "authority"
    clientIdKey: "clientId"
    clientSecretKey: "clientSecret"
    nameClaimKey: "nameClaim"

  dataprotection:
    storage:
      enable: true
      size: 100Mi
    encryption:
      enable: false
      secretRef: 'jit-access-frontend-dataprotection'
      certificateKey: 'dataprotection.pfx'
      passphraseKey: 'passphrase'

  container:
    image:
      repository: itsthatdood/jit-access-frontend
      tag: latest
    imagePullPolicy: Always
    resources:
      limits:
        cpu: 500m
        memory: 128Mi
      requests:
        cpu: 10m
        memory: 64Mi
    env: []
    livenessProbe:
      initialDelaySeconds: 15
      periodSeconds: 20
      httpGet:
        path: /healthz
        port: 8080
    readinessProbe:
      initialDelaySeconds: 5
      periodSeconds: 10
      httpGet:
        path: /healthz
        port: 8080
    securityContext:
      allowPrivilegeEscalation: false
      capabilities:
        drop:
          - "ALL"

  securityContext:
    runAsNonRoot: true
    seccompProfile:
      type: RuntimeDefault

  terminationGracePeriodSeconds: 10
  serviceAccountName: jit-access-frontend

  ingress:
    enable: true
    annotations: []
    className: ""
    tls:
      - hosts:
        - x.y.z
        secretName: ""
    hosts:
      - host: x.y.z
        paths:
          - path: '/'
            pathType: Prefix